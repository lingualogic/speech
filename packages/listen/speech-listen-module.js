/**
 * Speech-Listen Bundle
 *
 * Version: 0.6.1
 * Build:   0002
 * TYPE:    alpha
 * Datum:   08.01.2022
 *
 * Autor:   LinguaLogic Team
 * Lizenz:  MIT
 *
 *
 * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
 * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
 * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

import{Factory as t,SPEECH_VERSION_NUMBER as e,SPEECH_VERSION_BUILD as n,SPEECH_VERSION_TYPE as i,SPEECH_VERSION_DATE as s,Plugin as o,FactoryManager as r,PortManager as u,PORT_ASR_ACTION as h,CLOUD_GOOGLE_PORT as c,CLOUD_MICROSOFT_PORT as a,PluginGroup as m,PluginList as S,PluginFactory as L,EventFunctionList as g,SPEECH_LISTENRESULT_EVENT as l,SPEECH_LISTENINTERIMRESULT_EVENT as R,SPEECH_LISTENNOMATCH_EVENT as d,SPEECH_LISTENRECOGNITIONSTART_EVENT as p,SPEECH_LISTENRECOGNITIONSTOP_EVENT as v,SPEECH_LISTENAUDIOSTART_EVENT as A,SPEECH_LISTENAUDIOSTOP_EVENT as E,SPEECH_LISTENSOUNDSTART_EVENT as _,SPEECH_LISTENSOUNDSTOP_EVENT as F,SPEECH_LISTENSPEECHSTART_EVENT as P,SPEECH_LISTENSPEECHSTOP_EVENT as f,Builder as O,SystemManager as C}from'@speech/core';import{BaseComponent as M,BaseMobile as k,Base as b}from'@speech/base';import{Service as w,EventEmitter as N,ServiceManager as x}from'@speech/service';const y='SpeechRecognitionFactory',T='SpeechRecognition',I='SpeechGrammar';class G extends t{constructor(t,e=!0){super(t||"SpeechRecognitionFactory",e)}isMock(){return!1}getType(){return"SpeechRecognition"}getName(){return"SpeechRecognitionFactory"}create(t,e,n=!0){const i=t||"SpeechRecognition";try{return"SpeechRecognition"===i?window.SpeechRecognition||window.webkitSpeechRecognition||null:"SpeechGrammar"===i&&(window.SpeechGrammarList||window.webkitSpeechGrammarList)||null}catch(t){return this.exception('create',t),null}}getSpeechRecognitionClass(){return this.create()}getSpeechGrammarListClass(){return this.create("SpeechGrammar")}}const K=e,D=n,H=i,B=s,V=K+'.'+D+' vom '+B+' ('+H+')',U='1.6',j='Listen',z='ListenBuilder',X='ListenFactory',Y='ListenComponentBuilder',q='ListenComponentFactory',J='ListenComponent',Q="ListenComponent",W='ListenMock',Z='ListenService',$='ListenServiceMock',tt=!1,et='ASRHtml5',nt='ASRGoogle',it='ASRMicrosoft',st='de',ot='en',rt="de",ut='',ht='Command',ct='Dictate',at="Command",mt='';class St extends o{constructor(t,e=!0){super(t||"ASR",e),this.mListenRunningFlag=!1,this.mListenLanguage="de-DE",this.mListenMode="Command",this.mListenTimeoutId=0,this.mListenTimeoutTime=3e4,this.mListenResultFlag=!1,this.mOnListenStartFunc=null,this.mOnListenStopFunc=null,this.mOnListenResultFunc=null,this.mOnListenInterimResultFunc=null,this.mOnListenNoMatchFunc=null,this.mOnListenRecognitionStartFunc=null,this.mOnListenRecognitionStopFunc=null,this.mOnListenAudioStartFunc=null,this.mOnListenAudioStopFunc=null,this.mOnListenSoundStartFunc=null,this.mOnListenSoundStopFunc=null,this.mOnListenSpeechStartFunc=null,this.mOnListenSpeechStopFunc=null}getType(){return"ASR"}getClass(){return'ASRPlugin'}init(t){return this.isInit()?(this.error('init','init doppelt aufgerufen'),-1):0!==super.init(t)?(console.log('ASRPlugin.init: super.init -1'),-1):this._detectRecognition()?0!==this._initRecognition(t)?(this.setActiveOff(),0):0:(this.setActiveOff(),0)}done(){return this.isListenRunning()&&this.abortListen(),this._clearRecognitionTimeout(),this.mListenTimeoutTime=3e4,this.mListenRunningFlag=!1,this.mListenLanguage="de-DE",this.mListenMode="Command",this.mOnListenStartFunc=null,this.mOnListenStopFunc=null,this.mOnListenResultFunc=null,this.mOnListenInterimResultFunc=null,this.mOnListenNoMatchFunc=null,this.mOnListenRecognitionStartFunc=null,this.mOnListenRecognitionStopFunc=null,this.mOnListenAudioStartFunc=null,this.mOnListenAudioStopFunc=null,this.mOnListenSoundStartFunc=null,this.mOnListenSoundStopFunc=null,this.mOnListenSpeechStartFunc=null,this.mOnListenSpeechStopFunc=null,super.done()}isActive(){return!!this._isRecognition()&&super.isActive()}setActiveOn(){return this._isRecognition()?super.setActiveOn():-1}setCloudPortName(t){}getCloudPortName(){return''}_onListenStart(){try{return'function'==typeof this.mOnListenStartFunc?this.mOnListenStartFunc():0}catch(t){return this.exception('_onListenStart',t),-1}}_onListenStop(){try{return'function'==typeof this.mOnListenStopFunc?this.mOnListenStopFunc():0}catch(t){return this.exception('_onListenStop',t),-1}}_onListenResult(t){try{return'function'==typeof this.mOnListenResultFunc?this.mOnListenResultFunc(t):0}catch(t){return this.exception('_onListenResult',t),-1}}_onListenInterimResult(t){try{return'function'==typeof this.mOnListenInterimResultFunc?this.mOnListenInterimResultFunc(t):0}catch(t){return this.exception('_onListenInterimResult',t),-1}}_onListenNoMatch(){try{return'function'==typeof this.mOnListenNoMatchFunc?this.mOnListenNoMatchFunc():0}catch(t){return this.exception('_onListenNoMatch',t),-1}}_onListenRecognitionStart(){try{return'function'==typeof this.mOnListenRecognitionStartFunc?this.mOnListenRecognitionStartFunc():0}catch(t){return this.exception('_onListenRecognitionStart',t),-1}}_onListenRecognitionStop(){try{return'function'==typeof this.mOnListenRecognitionStopFunc?this.mOnListenRecognitionStopFunc():0}catch(t){return this.exception('_onListenRecognitionStop',t),-1}}_onListenAudioStart(){try{return'function'==typeof this.mOnListenAudioStartFunc?this.mOnListenAudioStartFunc():0}catch(t){return this.exception('_onListenAudioStart',t),-1}}_onListenAudioStop(){try{return'function'==typeof this.mOnListenAudioStopFunc?this.mOnListenAudioStopFunc():0}catch(t){return this.exception('_onListenAudioStop',t),-1}}_onListenSoundStart(){try{return'function'==typeof this.mOnListenSoundStartFunc?this.mOnListenSoundStartFunc():0}catch(t){return this.exception('_onListenSoundStart',t),-1}}_onListenSoundStop(){try{return'function'==typeof this.mOnListenSoundStopFunc?this.mOnListenSoundStopFunc():0}catch(t){return this.exception('_onListenSoundStop',t),-1}}_onListenSpeechStart(){try{return'function'==typeof this.mOnListenSpeechStartFunc?this.mOnListenSpeechStartFunc():0}catch(t){return this.exception('_onListenSpeechStart',t),-1}}_onListenSpeechStop(){try{return'function'==typeof this.mOnListenSpeechStopFunc?this.mOnListenSpeechStopFunc():0}catch(t){return this.exception('_onListenSpeechStop',t),-1}}set onListenStart(t){this.mOnListenStartFunc=t}set onListenStop(t){this.mOnListenStopFunc=t}set onListenResult(t){this.mOnListenResultFunc=t}set onListenInterimResult(t){this.mOnListenInterimResultFunc=t}set onListenNoMatch(t){this.mOnListenNoMatchFunc=t}set onListenRecognitionStart(t){this.mOnListenRecognitionStartFunc=t}set onListenRecognitionStop(t){this.mOnListenRecognitionStopFunc=t}set onListenAudioStart(t){this.mOnListenAudioStartFunc=t}set onListenAudioStop(t){this.mOnListenAudioStopFunc=t}set onListenSoundStart(t){this.mOnListenSoundStartFunc=t}set onListenSoundStop(t){this.mOnListenSoundStopFunc=t}set onListenSpeechStart(t){this.mOnListenSpeechStartFunc=t}set onListenSpeechStop(t){this.mOnListenSpeechStopFunc=t}_detectRecognition(){return!1}_initRecognition(t){return-1}_isRecognition(){return!1}_setRecognitionTimeout(){this._clearRecognitionTimeout(),this.mListenTimeoutId=window.setTimeout((()=>this.stopListen()),this.mListenTimeoutTime)}_clearRecognitionTimeout(){this.mListenTimeoutId&&(clearTimeout(this.mListenTimeoutId),this.mListenTimeoutId=0)}_onRecognitionStart(){return this._onListenRecognitionStart()}_onRecognitionEnd(){return this._onListenRecognitionStop(),this._stopListen()}_onRecognitionAudioStart(){return this.isDictateMode()&&this._setRecognitionTimeout(),this._onListenAudioStart()}_onRecognitionAudioEnd(){return this._onListenAudioStop()}_onRecognitionSoundStart(){return this._onListenSoundStart()}_onRecognitionSoundEnd(){return this._onListenSoundStop()}_onRecognitionSpeechStart(){return this._clearRecognitionTimeout(),this._onListenSpeechStart()}_onRecognitionSpeechEnd(){return this._onListenSpeechStop()}_getRecognitionResult(t){return t}_isRecognitionFinalResult(t){return!0}_onRecognitionResult(t){let e=0;try{this.mListenResultFlag=!0,this._isRecognitionFinalResult(t)?(e=this._onListenResult(this._getRecognitionResult(t)),this.isDictateMode()&&this._setRecognitionTimeout()):(e=this._onListenInterimResult(this._getRecognitionResult(t)),this.isDictateMode()&&this._clearRecognitionTimeout())}catch(t){this.exception('_onRecognitionResult',t),e=-1}return this.isCommandMode()&&0!==this._stopListen()&&(e=-1),e}_onRecognitionNoMatch(t){let e=this._onListenNoMatch();return this.isCommandMode()&&0!==this._stopListen()&&(e=-1),e}_onRecognitionError(t){this._clearRecognitionTimeout();try{let e=t;if('string'==typeof t.error&&!t.message)switch(t.error){case'network':e=new Error('ASR-Error: Netzwerk nicht eingeschaltet');break;case'no-speech':e=new Error('ASR-Error: Keine Sprache aufgenommen');break;case'not-allowed':e=new Error('ASR-Error: Kein Mikrofon vorhanden');break;default:e=new Error('ASR-Error: '+t.error)}let n=this._onError(e);return 0!==this._stopListen()&&(n=-1),n}catch(t){return this.exception('_onRecognitionError',t),-1}}_startRecognition(){return-1}_stopRecognition(){return-1}_abortRecognition(){return-1}_isRecognitionRunning(){return!1}isASR(){return!0}insertASR(t,e,n){return-1}removeASR(t){return 0}setASR(t){return 0}getASR(){return this.getName()}getASRList(){return[this.getName()]}setLanguage(t){let e=0;switch(t){case'de':this.mListenLanguage="de-DE";break;case'en':this.mListenLanguage="en-US";break;default:this.error('setLanguage','keine gueltige Sprache uebergeben'),e=-1}return e}getLanguage(){let t='';switch(this.mListenLanguage){case"de-DE":t='de';break;case"en-US":t='en';break;default:t=''}return t}getLanguageList(){return['de','en']}_getASRLanguage(){return this.mListenLanguage}isMode(t){return"Command"===t}isCommandMode(){return"Command"===this.mListenMode}isDictateMode(){return"Dictate"===this.mListenMode}setMode(t){return this.isMode(t)?(this.mListenMode=t,0):(this.error('setMode','kein gueltiger Eingabemodus uebergeben'),-1)}getMode(){return this.mListenMode}getModeList(){return["Command"]}isListenRunning(){return this.mListenRunningFlag&&this._isRecognitionRunning()}setListenTimeout(t){this.mListenTimeoutTime=t}startListen(){if(this.mListenResultFlag=!1,!this.isActive())return this.isErrorOutput()&&console.log('ASRPlugin.startListen: ASR ist nicht aktiv'),0;if(this.isListenRunning())return this.error('startListen','Spracheingabe laeuft bereits'),-1;this._setRecognitionTimeout();try{if(0!==this._startRecognition())return-1}catch(t){return this.exception('startListen',t),-1}return this.mListenRunningFlag=!0,this._onListenStart()}getStartListenFunc(){return()=>this.startListen()}_stopListen(){return this.isListenRunning()&&(this.mListenRunningFlag=!1,this._clearRecognitionTimeout(),this.mListenResultFlag||this._onListenNoMatch(),0!==this._onListenStop())?-1:0}stopListen(){if(!this.isActive())return console.log('ASRPlugin._stopAbortListen: no Active'),this.isErrorOutput()&&console.log('ASRPlugin.stopListen: ASR ist nicht aktiv'),0;if(!this.isListenRunning())return 0;this._clearRecognitionTimeout();let t=0;try{t=this._stopRecognition()}catch(e){this.exception('stopListen',e),t=-1}return this.isListenRunning()&&(this.mListenRunningFlag=!1,this.mListenResultFlag||this._onListenNoMatch(),0!==this._onListenStop()&&(t=-1)),t}getStopListenFunc(){return()=>this.stopListen()}abortListen(){if(!this.isActive())return this.isErrorOutput()&&console.log('ASRPlugin.abortListen: ASR ist nicht aktiv'),0;if(!this.isListenRunning())return 0;this._clearRecognitionTimeout();let t=0;try{t=this._abortRecognition()}catch(e){this.exception('abortListen',e),t=-1}return this.isListenRunning()&&(this.mListenRunningFlag=!1,this.mListenResultFlag||this._onListenNoMatch(),0!==this._onListenStop()&&(t=-1)),t}getAbortListenFunc(){return()=>this.abortListen()}}class Lt extends St{constructor(t,e=!0){super(t||"ASRMock",e),this.recognitionFlag=!0,this.recognitionResult='',this.initRecognitionResult=0,this.startRecognitionResult=0,this.startRecognitionExceptionFlag=!1,this.startRecognitionExceptionText='TestException startRecognition',this.stopRecognitionResult=0,this.stopRecognitionExceptionFlag=!1,this.stopRecognitionExceptionText='TestException stopRecognition',this.abortRecognitionResult=0,this.abortRecognitionExceptionFlag=!1,this.abortRecognitionExceptionText='TestException abortRecognition',this.onStartFunc=()=>0,this.onEndFunc=()=>0,this.onRecognitionStartFunc=()=>0,this.onRecognitionEndFunc=()=>0,this.onAudioStartFunc=()=>0,this.onAudioEndFunc=()=>0,this.onSoundStartFunc=()=>0,this.onSoundEndFunc=()=>0,this.onSpeechStartFunc=()=>0,this.onSpeechEndFunc=()=>0,this.onResultFunc=()=>'',this.onInterimResultFunc=()=>'',this.onNoMatchFunc=()=>0,this.onErrorFunc=()=>0}getClass(){return'ASRMock'}isMock(){return!0}done(){return this.recognitionFlag=!0,this.recognitionResult=null,this.initRecognitionResult=0,this.startRecognitionResult=0,this.stopRecognitionResult=0,this.abortRecognitionResult=0,this.startRecognitionExceptionFlag=!1,this.stopRecognitionExceptionFlag=!1,this.abortRecognitionExceptionFlag=!1,this.startRecognitionExceptionText='TestException startRecognition',this.stopRecognitionExceptionText='TestException stopRecognition',this.abortRecognitionExceptionText='TestException abortRecognition',this.onStartFunc=()=>0,this.onEndFunc=()=>0,this.onRecognitionStartFunc=()=>0,this.onRecognitionEndFunc=()=>0,this.onAudioStartFunc=()=>0,this.onAudioEndFunc=()=>0,this.onSoundStartFunc=()=>0,this.onSoundEndFunc=()=>0,this.onSpeechStartFunc=()=>0,this.onSpeechEndFunc=()=>0,this.onResultFunc=()=>'',this.onInterimResultFunc=()=>'',this.onNoMatchFunc=()=>0,this.onErrorFunc=()=>0,super.done()}_detectRecognition(){return this.recognitionFlag}_initRecognition(t){return this.initRecognitionResult}_isRecognition(){return this.recognitionFlag}_getRecognitionResult(t){return this.recognitionResult}_startRecognition(){if(this.startRecognitionExceptionFlag)throw new Error(this.startRecognitionExceptionText);return this.onStartFunc(),this.onRecognitionStartFunc(),this.onAudioStartFunc(),this.onSpeechStartFunc(),this.onInterimResultFunc(),this.onResultFunc(),this.onNoMatchFunc(),this.onSpeechEndFunc(),this.onAudioEndFunc(),this.onRecognitionEndFunc(),this.onErrorFunc(),this.onEndFunc(),this.startRecognitionResult}_stopRecognition(){if(this.stopRecognitionExceptionFlag)throw new Error(this.stopRecognitionExceptionText);return this.onSpeechEndFunc(),this.onAudioEndFunc(),this.onRecognitionEndFunc(),this.onErrorFunc(),this.onEndFunc(),this.stopRecognitionResult}_abortRecognition(){if(this.abortRecognitionExceptionFlag)throw new Error(this.abortRecognitionExceptionText);return this.onEndFunc(),this.onErrorFunc(),this.abortRecognitionResult}}class gt extends St{constructor(t,e=!0){super(t||"ASRHtml5",e),this.mRecognitionFactory=null,this.mRecognitionClass=null,this.mGrammarListClass=null,this.mGrammarList=null,this.mRecognition=null,this.mBreakTimeout=0,this.mRecognitionFactory=r.get("SpeechRecognitionFactory",G),this.mRecognitionFactory.setErrorOutputFunc(this._getErrorOutputFunc())}getClass(){return'ASRHtml5'}done(){if(this._clearBreakTimeout(),this.isListenRunning()&&this.mRecognition)try{this.mRecognition.abort()}catch(t){this.exception('done',t)}return this.mRecognitionClass=null,this.mGrammarListClass=null,this.mGrammarList=null,this.mRecognition=null,super.done()}setErrorOutput(t){this.mRecognitionFactory&&this.mRecognitionFactory.setErrorOutput(t),super.setErrorOutput(t)}_breakRecognition(){this.mBreakTimeout=0,this.error('_breakRecognition','Kein SpeechRecognition-Service vorhanden'),this.abortListen()}_setBreakTimeout(){this.mBreakTimeout=window.setTimeout((()=>this._breakRecognition()),5e3)}_clearBreakTimeout(){this.mBreakTimeout>0&&(clearTimeout(this.mBreakTimeout),this.mBreakTimeout=0)}isMode(t){return"Dictate"===t||super.isMode(t)}getModeList(){return["Command","Dictate"]}_detectRecognition(){if(!this.mRecognitionFactory)return this.error('_detectRecognition','keine Recognition-Fabrik vorhanden'),!1;try{this.mRecognitionClass=this.mRecognitionFactory.getSpeechRecognitionClass()}catch(t){return this.exception('_detectRecognition',t),!1}return null!==this.mRecognitionClass||(this.error('_detectRecognition','Kein HTML5 SpeechRecognition API vorhanden'),!1)}_initRecognition(t){try{return this.mRecognition=new this.mRecognitionClass,this.mRecognition.lang=this._getASRLanguage(),this.mRecognition.continuous=!1,this.mRecognition.interimResults=!1,this.mRecognition.maxAlternatives=1,this.mRecognition.onstart=()=>{this._clearBreakTimeout(),this._onRecognitionStart()},this.mRecognition.onend=()=>this._onRecognitionEnd(),this.mRecognition.onaudiostart=()=>this._onRecognitionAudioStart(),this.mRecognition.onaudioend=()=>this._onRecognitionAudioEnd(),this.mRecognition.onsoundstart=()=>this._onRecognitionSoundStart(),this.mRecognition.msoundend=()=>this._onRecognitionSoundEnd(),this.mRecognition.onspeechstart=()=>{this._clearBreakTimeout(),this._onRecognitionSpeechStart()},this.mRecognition.onspeechend=()=>this._onRecognitionSpeechEnd(),this.mRecognition.onresult=t=>{this._onRecognitionResult(t)},this.mRecognition.onnomatch=t=>this._onRecognitionNoMatch(t),this.mRecognition.onerror=t=>{this._clearBreakTimeout(),this._onRecognitionError(t)},0}catch(t){return this.exception('_initRecognition',t),-1}}_isRecognition(){return!!this.mRecognition}_isRecognitionRunning(){return!!this.mRecognition}_getRecognitionResult(t){if(!t.results)return'';try{return t.results[0][0].transcript}catch(t){return this.exception('_getRecognitionResult',t),''}}_isRecognitionFinalResult(t){if(!t.results)return!0;try{const e=t.results.length-1;return'boolean'!=typeof t.results[e].isFinal||t.results[e].isFinal}catch(t){return this.exception('_getRecognitionFinalResult',t),!1}}_startRecognition(){return this.mRecognition?(this._setBreakTimeout(),this.mRecognition.lang=this._getASRLanguage(),this.isDictateMode()?(this.mRecognition.continuous=!0,this.mRecognition.interimResults=!0):(this.mRecognition.continuous=!1,this.mRecognition.interimResults=!1),this.mRecognition.abort(),this.mRecognition.start(),0):-1}_stopRecognition(){return this.mRecognition?(this._clearBreakTimeout(),this.mRecognition.stop(),0):-1}_abortRecognition(){return this.mRecognition?(this._clearBreakTimeout(),this.mRecognition.abort(),0):-1}test(t,e){let n='',i=-1,s='';if('say'===t)e&&e.sayText&&(n=e.sayText),this.mRecognition&&'function'==typeof this.mRecognition.say?(this.mRecognition.say(n),i=0):s='Kein Corti-Mock von SpeechRecognition vorhanden';else s='kein gueltiges Testkommando uebergeben';return{result:i,errorText:s}}}class lt extends St{constructor(t,e=!0){super(t||"ASRPort",e),this.mPort=null,this.mPortName='',this.mCloudPortName='',this.mPortName=t}getClass(){return'ASRPort'}_setOption(t){return'string'==typeof t.cloudPortName&&(this.mCloudPortName=t.cloudPortName),0}done(){return this.mPort&&(this.mPort.removeAllEvent(this.mPortName),this.mPort=null),super.done()}setCloudPortName(t){this.mCloudPortName=t}getCloudPortName(){return this.mCloudPortName}setErrorOutput(t){super.setErrorOutput(t),this.mPort&&(t?this.mPort.setErrorOutputOn():this.mPort.setErrorOutputOff())}_detectRecognition(){return this.mCloudPortName?(this.mPort=u.find(this.mCloudPortName),!!this.mPort||(this.error('_detectRecognition','kein Port vorhanden'),!1)):(this.error('_detectRecognition','kein CloudPortName vorhanden'),!1)}_initRecognition(t){return this.mPort?this.mPort.isInit()?(this.mPort.addStartEvent(this.mPortName,(t=>(this._onRecognitionStart(),0))),this.mPort.addStopEvent(this.mPortName,(t=>(this._onRecognitionEnd(),0))),this.mPort.addResultEvent(this.mPortName,(t=>(this._onRecognitionResult(t.data),0))),this.mPort.addErrorEvent(this.mPortName,(t=>(this._checkErrorMessage(t.message),this._onRecognitionError(t),0))),0):(this.error('_initRecognition','Port ist nicht initialisiert'),-1):(this.error('_initRecognition','kein Port vorhanden'),-1)}_checkErrorMessage(t){}_isRecognition(){return!!this.mPort&&this.mPort.isAction(h)}_getRecognitionResult(t){return t}_startRecognition(){return this.mPort?this.mPort.start(this.mPortName,h,{language:this._getASRLanguage()}):-1}_stopRecognition(){return this.mPort?this.mPort.stop(this.mPortName,h):-1}_abortRecognition(){return this.mPort?this._stopRecognition():-1}_isRecognitionRunning(){return!!this.mPort&&this.mPort.isRunning(this.mPortName,h)}}class Rt extends lt{constructor(t,e=!0){super(t||"ASRGoogle",e),this.setCloudPortName(c)}getClass(){return'ASRGoogle'}_checkErrorMessage(t){'GoogleASR2.getAccessTokenFromServer: Failed to fetch'===t&&this.setActiveOff()}_getRecognitionResult(t){return t[0].transcript}}class dt extends lt{constructor(t,e=!0){super(t||"ASRMicrosoft",e),this.setCloudPortName(a)}getClass(){return'ASRMicrosoft'}_getRecognitionResult(t){return t.text}}class pt extends m{constructor(t,e,n=!0){super(e||"ASRGroup",n),this.mASRFactory=null,this.mASRList=new S,this.mASRHtml5=null,this.mASRGoogle=null,this.mASRMicrosoft=null,this.mCurrentASR=null,this.mOnListenStartFunc=null,this.mOnListenStopFunc=null,this.mOnListenResultFunc=null,this.mOnListenInterimResultFunc=null,this.mOnListenNoMatchFunc=null,this.mOnListenRecognitionStartFunc=null,this.mOnListenRecognitionStopFunc=null,this.mOnListenAudioStartFunc=null,this.mOnListenAudioStopFunc=null,this.mOnListenSoundStartFunc=null,this.mOnListenSoundStopFunc=null,this.mOnListenSpeechStartFunc=null,this.mOnListenSpeechStopFunc=null,this.mASRFactory=t,this._insertAllASR()}getType(){return"ASR"}getClass(){return'ASRGroup'}setCloudPortName(t){}getCloudPortName(){return''}_insertAllASR(){this.mASRFactory?(this.insertPlugin("ASRHtml5",this.mASRFactory.create("ASRHtml5","ASRHtml5",!1)),this.insertPlugin("ASRGoogle",this.mASRFactory.create("ASRGoogle","ASRGoogle",!1)),this.insertPlugin("ASRMicrosoft",this.mASRFactory.create("ASRMicrosoft","ASRMicrosoft",!1))):this.error('_insertAllASR','keine ASR-Fabrik vorhanden')}_initASRHtml5(t){if(this.mASRHtml5=this.findPlugin("ASRHtml5"),this.mASRHtml5){if(this.mASRHtml5.init(t),this.mASRHtml5.isActive())return void(this.isErrorOutput()&&console.log('ASRGroup._initASRHtml5: ASR eingefuegt'));this.removePlugin("ASRHtml5"),this.mASRHtml5.done(),this.mASRHtml5=null}this.isErrorOutput()&&console.log('ASRGroup._initASRHtml5: ASR nicht eingefuegt')}_initASRGoogle(t){if(this.mASRGoogle=this.findPlugin("ASRGoogle"),this.mASRGoogle){if(this.mASRGoogle.init(t),this.mASRGoogle.isActive())return void(this.isErrorOutput()&&console.log('ASRGroup._initASRGoogle: ASR eingefuegt'));this.removePlugin("ASRGoogle"),this.mASRGoogle.done(),this.mASRGoogle=null}this.isErrorOutput()&&console.log('ASRGroup._initASRGoogle: ASR nicht eingefuegt')}_initASRMicrosoft(t){if(this.mASRMicrosoft=this.findPlugin("ASRMicrosoft"),this.mASRMicrosoft){if(this.mASRMicrosoft.init(t),this.mASRMicrosoft.isActive())return void(this.isErrorOutput()&&console.log('ASRGroup._initASRMicrosoft: ASR eingefuegt'));this.removePlugin("ASRMicrosoft"),this.mASRMicrosoft.done(),this.mASRMicrosoft=null}this.isErrorOutput()&&console.log('ASRGroup._initASRMicrosoft: ASR nicht eingefuegt')}init(t){if(this.isInit())return this.error('init','init doppelt aufgerufen'),-1;if(!this.mASRFactory)return this.error('init','keine ASR-Fabrik vorhanden'),-1;const e=t||{};return this.isErrorOutput()||(e.errorOutputFlag=!1),this._initASRHtml5(e),this._initASRGoogle(e),this._initASRMicrosoft(e),0!==super.init(t)?-1:(this.mCurrentASR=this.firstPlugin(),this.mCurrentASR||(this.isErrorOutput()&&console.log('ASRGroup.init: keine ASR verfuegbar'),this.setActiveOff()),t&&t.tts&&this.setASR(t.tts),0)}done(){return this.mASRHtml5=null,this.mASRGoogle=null,this.mASRMicrosoft=null,this.mCurrentASR=null,this.mOnListenStartFunc=null,this.mOnListenStopFunc=null,this.mOnListenResultFunc=null,this.mOnListenInterimResultFunc=null,this.mOnListenNoMatchFunc=null,this.mOnListenRecognitionStartFunc=null,this.mOnListenRecognitionStopFunc=null,this.mOnListenAudioStartFunc=null,this.mOnListenAudioStopFunc=null,this.mOnListenSoundStartFunc=null,this.mOnListenSoundStopFunc=null,this.mOnListenSpeechStartFunc=null,this.mOnListenSpeechStopFunc=null,super.done()}isActive(){return this.mCurrentASR?this.mCurrentASR.isActive()?super.isActive():(this.isErrorOutput()&&console.log('ASRGroup.isActive: ASR ist nicht aktiv ',this.mCurrentASR.getName()),!1):(this.isErrorOutput()&&console.log('ASRGroup.isActive: keine ASR eingestellt'),!1)}setActiveOn(){return this.mCurrentASR&&this.mCurrentASR.isActive()?super.setActiveOn():-1}set onInit(t){this.mOnInitFunc=t;let e=this.firstPlugin();for(;e;)e.onInit=t,e=this.nextPlugin()}set onListenStart(t){this.mOnListenStartFunc=t;let e=this.firstPlugin();for(;e;)e.onListenStart=t,e=this.nextPlugin()}set onListenStop(t){this.mOnListenStopFunc=t;let e=this.firstPlugin();for(;e;)e.onListenStop=t,e=this.nextPlugin()}set onListenResult(t){this.mOnListenResultFunc=t;let e=this.firstPlugin();for(;e;)e.onListenResult=t,e=this.nextPlugin()}set onListenInterimResult(t){this.mOnListenInterimResultFunc=t;let e=this.firstPlugin();for(;e;)e.onListenInterimResult=t,e=this.nextPlugin()}set onListenNoMatch(t){this.mOnListenNoMatchFunc=t;let e=this.firstPlugin();for(;e;)e.onListenNoMatch=t,e=this.nextPlugin()}set onListenRecognitionStart(t){this.mOnListenRecognitionStartFunc=t;let e=this.firstPlugin();for(;e;)e.onListenRecognitionStart=t,e=this.nextPlugin()}set onListenRecognitionStop(t){this.mOnListenRecognitionStopFunc=t;let e=this.firstPlugin();for(;e;)e.onListenRecognitionStop=t,e=this.nextPlugin()}set onListenAudioStart(t){this.mOnListenAudioStartFunc=t;let e=this.firstPlugin();for(;e;)e.onListenAudioStart=t,e=this.nextPlugin()}set onListenAudioStop(t){this.mOnListenAudioStopFunc=t;let e=this.firstPlugin();for(;e;)e.onListenAudioStop=t,e=this.nextPlugin()}set onListenSoundStart(t){this.mOnListenSoundStartFunc=t;let e=this.firstPlugin();for(;e;)e.onListenSoundStart=t,e=this.nextPlugin()}set onListenSoundStop(t){this.mOnListenSoundStopFunc=t;let e=this.firstPlugin();for(;e;)e.onListenSoundStop=t,e=this.nextPlugin()}set onListenSpeechStart(t){this.mOnListenSpeechStartFunc=t;let e=this.firstPlugin();for(;e;)e.onListenSpeechStart=t,e=this.nextPlugin()}set onListenSpeechStop(t){this.mOnListenSpeechStopFunc=t;let e=this.firstPlugin();for(;e;)e.onListenSpeechStop=t,e=this.nextPlugin()}set onError(t){this.mOnErrorFunc=t;let e=this.firstPlugin();for(;e;)e.onError=t,e=this.nextPlugin()}isASR(){return!!this.mCurrentASR}insertASR(t,e,n){if(this.findPlugin(t))return 0;if(0!==this.insertPlugin(t,this.mASRFactory.create(t,e,!1)))return-1;const i=this.findPlugin(t);if(i){if(i.init(n),i.isActive()){this.isErrorOutput()&&console.log('ASRGroup.insertASR: ASR eingefuegt ',t,e),i.onInit=this.mOnInitFunc,i.onListenStart=this.mOnListenStartFunc,i.onListenStop=this.mOnListenStopFunc,i.onListenRecognitionStart=this.onListenRecognitionStart,i.onListenRecognitionStop=this.onListenRecognitionStop,i.onListenAudioStart=this.onListenAudioStart,i.onListenAudioStop=this.onListenAudioStop,i.onListenSoundStart=this.onListenSoundStart,i.onListenSoundStop=this.onListenSoundStop,i.onListenSpeechStart=this.onListenSpeechStart,i.onListenSpeechStop=this.onListenSpeechStop,i.onListenResult=this.mOnListenResultFunc,i.onListenInterimResult=this.onListenInterimResult,i.onListenNoMatch=this.onListenNoMatch,i.onError=this.mOnErrorFunc;let n=this.mASRList.insert(t,i);return''===this.getASR()&&0===this.setASR(t)&&(n=this.setActiveOn()),n}this.removePlugin(t)}return this.isErrorOutput()&&console.log('ASRGroup.insertASR: ASR nicht eingefuegt ',t,e),-1}removeASR(t){return this.mASRList.find(t)?(this.mASRList.remove(t),this.removePlugin(t)):(this.isErrorOutput()&&console.log('ASRGroup.removeASR: ASR nicht vorhanden'),-1)}setASR(t){let e=null;switch(t){case"ASRHtml5":e=this.mASRHtml5;break;case"ASRGoogle":e=this.mASRGoogle;break;case"ASRMicrosoft":e=this.mASRMicrosoft;break;default:e=this.mASRList.find(t)}return e?(this.mCurrentASR=e,0):(this.error('setASR','Keine ASR vorhanden'),-1)}getASR(){return this.mCurrentASR?this.mCurrentASR.getName():''}getASRList(){return this.getPluginNameList()}setLanguage(t){let e=0,n=this.firstPlugin();if(!n)return this.error('setLanguage','Keine ASR vorhanden'),-1;for(;n;)0!==n.setLanguage(t)&&(e=-1),n=this.nextPlugin();return e}getLanguage(){return this.mCurrentASR?this.mCurrentASR.getLanguage():''}getLanguageList(){return this.mCurrentASR?this.mCurrentASR.getLanguageList():[]}isMode(t){return!!this.mCurrentASR&&this.mCurrentASR.isMode(t)}isCommandMode(){return!!this.mCurrentASR&&this.mCurrentASR.isCommandMode()}isDictateMode(){return!!this.mCurrentASR&&this.mCurrentASR.isDictateMode()}setMode(t){if(!t)return this.error('setMode','Kein Eingabemodus uebergeben'),-1;let e=0,n=this.firstPlugin();if(!n)return this.error('setMode','Keine ASR vorhanden'),-1;for(;n;)n.isMode(t)&&0!==n.setMode(t)&&(e=-1),n=this.nextPlugin();return e}getMode(){return this.mCurrentASR?this.mCurrentASR.getMode():''}getModeList(){return this.mCurrentASR?this.mCurrentASR.getModeList():[]}isListenRunning(){return!!this.mCurrentASR&&this.mCurrentASR.isListenRunning()}setListenTimeout(t){this.mCurrentASR&&this.mCurrentASR.setListenTimeout(t)}startListen(){return this.mCurrentASR?this.isActive()?this.mCurrentASR.startListen():(this.isErrorOutput()&&console.log('ASRGroup.startListen: ASR ist nicht aktiv'),0):(this.error('startListen','keine ASR vorhanden'),-1)}getStartListenFunc(){return()=>this.startListen()}stopListen(){return this.isActive()?this.mCurrentASR?this.mCurrentASR.stopListen():(console.log('ASRGroup.stopListen: no currentASR'),-1):(this.isErrorOutput()&&console.log('ASRGroup.stopListen: ASR ist nicht aktiv'),0)}getStopListenFunc(){return()=>this.stopListen()}abortListen(){return this.isActive()?this.mCurrentASR.abortListen():(this.isErrorOutput()&&console.log('ASRGroup.abortListen: ASR ist nicht aktiv'),0)}getAbortListenFunc(){return()=>this.abortListen()}test(t,e){return this.isActive()?this.mCurrentASR.test(t,e):(this.isErrorOutput()&&console.log('ASRGroup.abortListen: ASR ist nicht aktiv'),0)}}class vt extends L{constructor(){super('ASRFactory')}getType(){return"ASR"}getName(){return"ASRFactory"}_newPlugin(t,e,n){let i=null;switch(e){case"ASRGroup":i=new pt(this,t,n);break;case"ASR":case"ASRHtml5":i=new gt(t,n);break;case"ASRPort":i=new lt(t,n);break;case"ASRGoogle":i=new Rt(t,n);break;case"ASRMicrosoft":i=new dt(t,n);break;case"ASRMock":i=new Lt("ASRMock",n);break;default:this.error('_newPlugin','keine ASR vorhanden')}return i}create(t="",e="",n=!0){const i=t||"ASRGroup",s=e||"ASRGroup";try{return this._newPlugin(i,s,n)}catch(t){return this.exception('create',t),null}}}class At extends M{constructor(t="",e=!0){super(t||"ListenComponent",e),this.mASRPlugin=null,this.mListenResultEvent=new g(l,"ListenComponent"),this.mListenInterimResultEvent=new g(R,"ListenComponent"),this.mListenNoMatchEvent=new g(d,"ListenComponent"),this.mListenRecognitionStartEvent=new g(p,"ListenComponent"),this.mListenRecognitionStopEvent=new g(v,"ListenComponent"),this.mListenAudioStartEvent=new g(A,"ListenComponent"),this.mListenAudioStopEvent=new g(E,"ListenComponent"),this.mListenSoundStartEvent=new g(_,"ListenComponent"),this.mListenSoundStopEvent=new g(F,"ListenComponent"),this.mListenSpeechStartEvent=new g(P,"ListenComponent"),this.mListenSpeechStopEvent=new g(f,"ListenComponent"),this.mASRActiveFlag=!1,this.mASRFeatureFlag=!1,this.mListenResultEvent.setErrorOutputFunc(this._getErrorOutputFunc()),this.mListenInterimResultEvent.setErrorOutputFunc(this._getErrorOutputFunc()),this.mListenNoMatchEvent.setErrorOutputFunc(this._getErrorOutputFunc()),this.mListenRecognitionStartEvent.setErrorOutputFunc(this._getErrorOutputFunc()),this.mListenRecognitionStopEvent.setErrorOutputFunc(this._getErrorOutputFunc()),this.mListenAudioStartEvent.setErrorOutputFunc(this._getErrorOutputFunc()),this.mListenAudioStopEvent.setErrorOutputFunc(this._getErrorOutputFunc()),this.mListenSoundStartEvent.setErrorOutputFunc(this._getErrorOutputFunc()),this.mListenSoundStopEvent.setErrorOutputFunc(this._getErrorOutputFunc()),this.mListenSpeechStartEvent.setErrorOutputFunc(this._getErrorOutputFunc()),this.mListenSpeechStopEvent.setErrorOutputFunc(this._getErrorOutputFunc())}getType(){return"Listen"}getClass(){return'ListenComponent'}getVersion(){return V}getApiVersion(){return"1.6"}getServerVersion(){return''}_setOption(t){return t?(t.listenLanguage&&this.setLanguage(t.listenLanguage),super._setOption(t)):-1}_initAllPlugin(t){if(this.mASRPlugin=this.findPlugin("ASRGroup"),t&&t.asrList)for(const e of t.asrList)e.asrName&&e.asrClass&&0!==this.mASRPlugin.insertASR(e.asrName,e.asrClass,e)&&this.error('_initAllPlugin','ASR wurd nicht eingetragen '+e.asrName);return this.mASRPlugin&&(this.mASRActiveFlag=this.mASRPlugin.isActive()),0}init(t){return 0!==super.init(t)?-1:(t&&'string'==typeof t.asrDefault&&this.setASR(t.asrDefault),0)}_doneAllPlugin(){this.mASRPlugin=null}_doneAllEvent(){this.mListenResultEvent.clear(),this.mListenInterimResultEvent.clear(),this.mListenNoMatchEvent.clear(),this.mListenRecognitionStartEvent.clear(),this.mListenRecognitionStopEvent.clear(),this.mListenAudioStartEvent.clear(),this.mListenAudioStopEvent.clear(),this.mListenSoundStartEvent.clear(),this.mListenSoundStopEvent.clear(),this.mListenSpeechStartEvent.clear(),this.mListenSpeechStopEvent.clear()}_doneAllAttribute(){this.mASRActiveFlag=!1,this.mASRFeatureFlag=!1}_resetAllDefault(){this.setLanguage("de")}reset(t){return super.reset(t)}isActive(){return!!this.mASRActiveFlag&&super.isActive()}setActiveOn(){return this.mASRActiveFlag?super.setActiveOn():-1}setFeatureList(t){return t.features?(t.features.ASR&&'boolean'==typeof t.features.ASR&&(this.mASRFeatureFlag=t.features.ASR),0):(this.error('setFeatureList','keine FeatureInfos uebergeben'),-1)}setErrorOutput(t){super.setErrorOutput(t),this.mListenResultEvent.setErrorOutput(t),this.mListenInterimResultEvent.setErrorOutput(t),this.mListenNoMatchEvent.setErrorOutput(t),this.mListenRecognitionStartEvent.setErrorOutput(t),this.mListenRecognitionStopEvent.setErrorOutput(t),this.mListenAudioStartEvent.setErrorOutput(t),this.mListenAudioStopEvent.setErrorOutput(t),this.mListenSoundStartEvent.setErrorOutput(t),this.mListenSoundStopEvent.setErrorOutput(t),this.mListenSpeechStartEvent.setErrorOutput(t),this.mListenSpeechStopEvent.setErrorOutput(t)}_onListenResult(t,e){return this.mListenResultEvent.dispatch(t)}_onListenInterimResult(t){return this.mListenInterimResultEvent.dispatch(t)}_onListenNoMatch(){return this.mListenNoMatchEvent.dispatch()}_onListenRecognitionStart(){return this.mListenRecognitionStartEvent.dispatch()}_onListenRecognitionStop(){return this.mListenRecognitionStopEvent.dispatch()}_onListenAudioStart(){return this.mListenAudioStartEvent.dispatch()}_onListenAudioStop(){return this.mListenAudioStopEvent.dispatch()}_onListenSoundStart(){return this.mListenSoundStartEvent.dispatch()}_onListenSoundStop(){return this.mListenSoundStopEvent.dispatch()}_onListenSpeechStart(){return this.mListenSpeechStartEvent.dispatch()}_onListenSpeechStop(){return this.mListenSpeechStopEvent.dispatch()}get onListenResult(){return t=>this._onListenResult(t)}get onListenInterimResult(){return t=>this._onListenInterimResult(t)}get onListenNoMatch(){return()=>this._onListenNoMatch()}get onListenRecognitionStart(){return()=>this._onListenRecognitionStart()}get onListenRecognitionStop(){return()=>this._onListenRecognitionStop()}get onListenAudioStart(){return()=>this._onListenAudioStart()}get onListenAudioStop(){return()=>this._onListenAudioStop()}get onListenSoundStart(){return()=>this._onListenSoundStart()}get onListenSoundStop(){return()=>this._onListenSoundStop()}get onListenSpeechStart(){return()=>this._onListenSpeechStart()}get onListenSpeechStop(){return()=>this._onListenSpeechStop()}addEventListener(t,e,n){let i=0;switch(e){case l:i=this.mListenResultEvent.addListener(t,n);break;case R:i=this.mListenInterimResultEvent.addListener(t,n);break;case d:i=this.mListenNoMatchEvent.addListener(t,n);break;case p:i=this.mListenRecognitionStartEvent.addListener(t,n);break;case v:i=this.mListenRecognitionStopEvent.addListener(t,n);break;case A:i=this.mListenAudioStartEvent.addListener(t,n);break;case E:i=this.mListenAudioStopEvent.addListener(t,n);break;case _:i=this.mListenSoundStartEvent.addListener(t,n);break;case F:i=this.mListenSoundStopEvent.addListener(t,n);break;case P:i=this.mListenSpeechStartEvent.addListener(t,n);break;case f:i=this.mListenSpeechStopEvent.addListener(t,n);break;default:i=super.addEventListener(t,e,n)}return i}removeEventListener(t,e){let n=0;switch(e){case l:n=this.mListenResultEvent.removeListener(t);break;case R:n=this.mListenInterimResultEvent.removeListener(t);break;case d:n=this.mListenNoMatchEvent.removeListener(t);break;case p:n=this.mListenRecognitionStartEvent.removeListener(t);break;case v:n=this.mListenRecognitionStopEvent.removeListener(t);break;case A:n=this.mListenAudioStartEvent.removeListener(t);break;case E:n=this.mListenAudioStopEvent.removeListener(t);break;case _:n=this.mListenSoundStartEvent.removeListener(t);break;case F:n=this.mListenSoundStopEvent.removeListener(t);break;case P:n=this.mListenSpeechStartEvent.removeListener(t);break;case f:n=this.mListenSpeechStopEvent.removeListener(t);break;default:n=super.removeEventListener(t,e)}return n}addListenResultEvent(t,e){return this.addEventListener(t,l,e)}addListenInterimResultEvent(t,e){return this.addEventListener(t,R,e)}addListenNoMatchEvent(t,e){return this.addEventListener(t,d,e)}addListenRecognitionStartEvent(t,e){return this.addEventListener(t,p,e)}addListenRecognitionStopEvent(t,e){return this.addEventListener(t,v,e)}addListenAudioStartEvent(t,e){return this.addEventListener(t,A,e)}addListenAudioStopEvent(t,e){return this.addEventListener(t,E,e)}addListenSoundStartEvent(t,e){return this.addEventListener(t,_,e)}addListenSoundStopEvent(t,e){return this.addEventListener(t,F,e)}addListenSpeechStartEvent(t,e){return this.addEventListener(t,P,e)}addListenSpeechStopEvent(t,e){return this.addEventListener(t,f,e)}removeListenResultEvent(t){return this.removeEventListener(t,l)}removeListenInterimResultEvent(t){return this.removeEventListener(t,R)}removeListenNoMatchEvent(t){return this.removeEventListener(t,d)}removeListenRecognitionStartEvent(t){return this.removeEventListener(t,p)}removeListenRecognitionStopEvent(t){return this.removeEventListener(t,v)}removeListenAudioStartEvent(t){return this.removeEventListener(t,A)}removeListenAudioStopEvent(t){return this.removeEventListener(t,E)}removeListenSoundStartEvent(t){return this.removeEventListener(t,_)}removeListenSoundStopEvent(t){return this.removeEventListener(t,F)}removeListenSpeechStartEvent(t){return this.removeEventListener(t,P)}removeListenSpeechStopEvent(t){return this.removeEventListener(t,f)}removeAllEvent(t){let e=super.removeAllEvent(t);return 0!==this.removeListenResultEvent(t)&&(e=-1),0!==this.removeListenInterimResultEvent(t)&&(e=-1),0!==this.removeListenNoMatchEvent(t)&&(e=-1),0!==this.removeListenRecognitionStartEvent(t)&&(e=-1),0!==this.removeListenRecognitionStopEvent(t)&&(e=-1),0!==this.removeListenAudioStartEvent(t)&&(e=-1),0!==this.removeListenAudioStopEvent(t)&&(e=-1),0!==this.removeListenSoundStartEvent(t)&&(e=-1),0!==this.removeListenSoundStopEvent(t)&&(e=-1),0!==this.removeListenSpeechStartEvent(t)&&(e=-1),0!==this.removeListenSpeechStopEvent(t)&&(e=-1),e}isASR(){return!(!this.mASRPlugin||!this.mASRPlugin.isASR())}setASR(t){return this.mASRPlugin?this.mASRPlugin.setASR(t):-1}getASR(){return this.mASRPlugin?this.mASRPlugin.getASR():''}getASRList(){return this.mASRPlugin?this.mASRPlugin.getASRList():[]}setTimeout(t){return this.mASRPlugin?(this.mASRPlugin.setListenTimeout(t),0):-1}setLanguage(t){return this.mASRPlugin?this.mASRPlugin.setLanguage(t):-1}getLanguage(){return this.mASRPlugin?this.mASRPlugin.getLanguage():""}getLanguageList(){return this.mASRPlugin?this.mASRPlugin.getLanguageList():[]}isMode(t){return!!this.mASRPlugin&&this.mASRPlugin.isMode(t)}isCommandMode(){return!!this.mASRPlugin&&this.mASRPlugin.isCommandMode()}isDictateMode(){return!!this.mASRPlugin&&this.mASRPlugin.isDictateMode()}setMode(t){return this.mASRPlugin?this.mASRPlugin.setMode(t):-1}getMode(){return this.mASRPlugin?this.mASRPlugin.getMode():""}getModeList(){return this.mASRPlugin?this.mASRPlugin.getModeList():[]}isRunning(){return!!this.isActive()&&(!!this.mASRPlugin&&this.mASRPlugin.isListenRunning())}start(){return this.isASR()?this.isActive()?this.mASRPlugin.startListen():(this.isErrorOutput()&&console.log('ListenComponent.start: Komponente ist nicht aktiv'),0):(this.error('start','keine ASR vorhanden'),-1)}stop(){return this.isActive()?this.mASRPlugin?this.mASRPlugin.stopListen():(this.error('stop','kein ASR vorhanden'),-1):(this.isErrorOutput()&&console.log('ListenComponent.stop: no Active'),0)}abort(){return this.isActive()?this.mASRPlugin?this.mASRPlugin.abortListen():(this.error('abort','kein ASR vorhanden'),-1):0}test(t,e){let n='';if('say'===t){if(this.mASRPlugin)return this.mASRPlugin.test(t,e);n='kein ASRPlugin vorhanden'}else n='kein gueltiges Testkommando uebergeben';return{result:-1,errorText:n}}}class Et extends L{constructor(){super('ListenComponentFactory')}getName(){return"ListenComponentFactory"}getType(){return"Listen"}_newPlugin(t,e,n){return new At(t,n)}create(t="",e="",n=!0){const i=t||"ListenComponent",s=e||"ListenComponent";try{return this._newPlugin(i,s,n)}catch(t){return this.exception('create',t),null}}}class _t extends O{constructor(t,e=!0){super(t||"Listen",e)}getType(){return"Listen"}getClass(){return'ListenComponentBuilder'}build(t){const e=this._getComponentName(t)||"ListenComponent";let n=this._findComponent(e);if(n)return n;try{n=this._buildComponent(t);const e=this._getPlugin("ASRGroup","ASRGroup","ASRFactory",vt);return 0!==this._binder(n,e)?(this.error('build','Komponenten nicht verbunden'),null):n}catch(t){return this.exception('build',t),null}}_buildComponent(t){const e=this._getComponentName(t)||"ListenComponent",n=this._getComponentClass(t)||"ListenComponent";return this._getPlugin(e,n,"ListenComponentFactory",Et)}_binder(t,e){return t?e?0!==t.insertPlugin(e.getName(),e)?(this.error('_binder','ASR-Plugin wurde nicht eingefuegt'),-1):(e.onInit=t.onInit,e.onListenStart=t.onStart,e.onListenStop=t.onStop,e.onListenRecognitionStart=t.onListenRecognitionStart,e.onListenRecognitionStop=t.onListenRecognitionStop,e.onListenAudioStart=t.onListenAudioStart,e.onListenAudioStop=t.onListenAudioStop,e.onListenSoundStart=t.onListenSoundStart,e.onListenSoundStop=t.onListenSoundStop,e.onListenSpeechStart=t.onListenSpeechStart,e.onListenSpeechStop=t.onListenSpeechStop,e.onListenResult=t.onListenResult,e.onListenInterimResult=t.onListenInterimResult,e.onListenNoMatch=t.onListenNoMatch,e.onError=t.onError,0):(this.error('_binder','Kein ASR-Plugin vorhanden'),-1):(this.error('_binder','Keine Listen-Komponente vorhanden'),-1)}}class Ft extends k{constructor(t){super('Listen',t),this.mListenAudioStartEvent=new g(A),this.mListenAudioStopEvent=new g(E),this.mListenSpeechStartEvent=new g(P),this.mListenSpeechStopEvent=new g(f),this.mListenResultEvent=new g(l),this.mListenInterimResultEvent=new g(R),this.mListenNoMatchEvent=new g(d),this.mASR='',this.mASRList=new Array(0),this.mLanguage='',this.mLanguageList=new Array(0),this.mInitEventFlag=!1,this.mInitEventCount=4}_initEvent(){this.mInitEventFlag&&(this.mInitEventCount--,0===this.mInitEventCount&&(this.mInitEventFlag=!1,this._onInit()))}_init(t){return console.log('Listen.init:',t),t&&'boolean'==typeof t.errorOutputFlag&&this.setErrorOutput(t.errorOutputFlag),window.cordova?window.ListenPlugin?(console.log('ListenPlugin-Objekt:',window.ListenPlugin),this.mPlugin=window.ListenPlugin,this.mPlugin.onInit=t=>{0==t?(this.mInitEventFlag=!0,this.mPlugin.getASRList(),this.mPlugin.getASR(),this.mPlugin.getLanguageList(),this.mPlugin.getLanguage()):this._onError(new Error('faild init'))},this.mPlugin.onStart=t=>{this.mRunningFlag=!0,this._onStart()},this.mPlugin.onStop=()=>{this.mRunningFlag=!1,this._onStop()},this.mPlugin.onAudioStart=()=>{this._onListenAudioStart()},this.mPlugin.onAudioStop=()=>{this._onListenAudioStop()},this.mPlugin.onSpeechStart=()=>{this._onListenSpeechStart()},this.mPlugin.onSpeechStop=()=>{this._onListenSpeechStop()},this.mPlugin.onResult=t=>{this._onListenResult(t)},this.mPlugin.onInterimResult=t=>{this._onListenInterimResult(t)},this.mPlugin.onNoMatch=()=>{this._onListenNoMatch()},this.mPlugin.onASRChanged=t=>{this.mASR=t,this._initEvent()},this.mPlugin.onASRList=t=>{this.mASRList=t,this._initEvent()},this.mPlugin.onLanguageChanged=t=>{this.mLanguage=t,this._initEvent()},this.mPlugin.onLanguageList=t=>{this.mLanguageList=t,this._initEvent()},this.mPlugin.onError=t=>{console.log('===> Event Listen.onError ',t),this.mRunningFlag=!1,this._onError(t)},console.log('ListenPlugin:',this.mPlugin),this.mPlugin.init(),0):(console.log('Listen: kein ListenPlugin von Cordova vorhanden'),-1):(console.log('Listen: kein Cordova vorhanden'),-1)}_onListenAudioStart(){return this.mListenAudioStartEvent.dispatch()}_onListenAudioStop(){return this.mListenAudioStopEvent.dispatch()}_onListenSpeechStart(){return this.mListenSpeechStartEvent.dispatch()}_onListenSpeechStop(){return this.mListenSpeechStopEvent.dispatch()}_onListenResult(t){return this.mListenResultEvent.dispatch(t)}_onListenInterimResult(t){return this.mListenInterimResultEvent.dispatch(t)}_onListenNoMatch(){return this.mListenNoMatchEvent.dispatch()}addEventListener(t,e,n){let i=0;switch(e){case A:i=this.mListenAudioStartEvent.addListener(t,n);break;case E:i=this.mListenAudioStopEvent.addListener(t,n);break;case P:i=this.mListenSpeechStartEvent.addListener(t,n);break;case f:i=this.mListenSpeechStopEvent.addListener(t,n);break;case l:case R:i=this.mListenResultEvent.addListener(t,n);break;case d:i=this.mListenNoMatchEvent.addListener(t,n);break;default:i=super.addEventListener(t,e,n)}return i}removeEventListener(t,e){let n=0;switch(e){case A:n=this.mListenAudioStartEvent.removeListener(t);break;case E:n=this.mListenAudioStopEvent.removeListener(t);break;case P:n=this.mListenSpeechStartEvent.removeListener(t);break;case f:n=this.mListenSpeechStopEvent.removeListener(t);break;case l:case R:n=this.mListenResultEvent.removeListener(t);break;case d:n=this.mListenNoMatchEvent.removeListener(t);break;default:n=super.removeEventListener(t,e)}return n}addListenResultEvent(t,e){return this.addEventListener(t,l,e)}addListenInterimResultEvent(t,e){return this.addEventListener(t,R,e)}addListenNoMatchEvent(t,e){return this.addEventListener(t,d,e)}addListenRecognitionStartEvent(t,e){return-1}addListenRecognitionStopEvent(t,e){return-1}addListenAudioStartEvent(t,e){return this.addEventListener(t,A,e)}addListenAudioStopEvent(t,e){return this.addEventListener(t,E,e)}addListenSoundStartEvent(t,e){return-1}addListenSoundStopEvent(t,e){return-1}addListenSpeechStartEvent(t,e){return this.addEventListener(t,P,e)}addListenSpeechStopEvent(t,e){return this.addEventListener(t,P,e)}removeListenResultEvent(t){return this.removeEventListener(t,l)}removeListenInterimResultEvent(t){return this.removeEventListener(t,R)}removeListenNoMatchEvent(t){return this.removeEventListener(t,d)}removeListenRecognitionStartEvent(t){return-1}removeListenRecognitionStopEvent(t){return-1}removeListenAudioStartEvent(t){return this.removeEventListener(t,A)}removeListenAudioStopEvent(t){return this.removeEventListener(t,E)}removeListenSoundStartEvent(t){return-1}removeListenSoundStopEvent(t){return-1}removeListenSpeechStartEvent(t){return this.removeEventListener(t,P)}removeListenSpeechStopEvent(t){return this.removeEventListener(t,f)}isASR(){return!!this.mASR}setASR(t){return this.mPlugin?(this.mPlugin.setASR(t),0):(console.log('Error Listen.setASR: kein Listen-Plugin vorhanden'),-1)}getASR(){return this.mASR}getASRList(){return this.mASRList}setLanguage(t){return this.mPlugin?(this.mPlugin.setLanguage(t),0):(console.log('Error Listen.setLanguage: kein Listen-Plugin vorhanden'),-1)}getLanguage(){return this.mLanguage}getLanguageList(){return this.mLanguageList}setTimeout(t){return 0}isMode(t){return!1}isCommandMode(){return!1}isDictateMode(){return!1}setMode(t){return 0}getMode(){return""}getModeList(){return[]}isRunning(){return this.mRunningFlag}start(){return this.mPlugin?(this.mPlugin.start(),0):(console.log('Error Listen.start: kein Listen-Plugin vorhanden'),-1)}stop(){return this.mPlugin?(this.mPlugin.stop(),0):(console.log('Error Listen.stop: kein Listen-Plugin vorhanden'),-1)}abort(){return this.stop()}}class Pt extends b{constructor(t){super(t),this.mListenComponent=this.mComponent}_getBuilderName(){return"Listen"}addListenResultEvent(t,e){return this.mListenComponent.addListenResultEvent(t,e)}addListenInterimResultEvent(t,e){return this.mListenComponent.addListenInterimResultEvent(t,e)}addListenNoMatchEvent(t,e){return this.mListenComponent.addListenNoMatchEvent(t,e)}addListenRecognitionStartEvent(t,e){return this.mListenComponent.addListenRecognitionStartEvent(t,e)}addListenRecognitionStopEvent(t,e){return this.mListenComponent.addListenRecognitionStopEvent(t,e)}addListenAudioStartEvent(t,e){return this.mListenComponent.addListenAudioStartEvent(t,e)}addListenAudioStopEvent(t,e){return this.mListenComponent.addListenAudioStopEvent(t,e)}addListenSoundStartEvent(t,e){return this.mListenComponent.addListenSoundStartEvent(t,e)}addListenSoundStopEvent(t,e){return this.mListenComponent.addListenSoundStopEvent(t,e)}addListenSpeechStartEvent(t,e){return this.mListenComponent.addListenSpeechStartEvent(t,e)}addListenSpeechStopEvent(t,e){return this.mListenComponent.addListenSpeechStopEvent(t,e)}removeListenResultEvent(t){return this.mListenComponent.removeListenResultEvent(t)}removeListenInterimResultEvent(t){return this.mListenComponent.removeListenInterimResultEvent(t)}removeListenNoMatchEvent(t){return this.mListenComponent.removeListenNoMatchEvent(t)}removeListenRecognitionStartEvent(t){return this.mListenComponent.removeListenRecognitionStartEvent(t)}removeListenRecognitionStopEvent(t){return this.mListenComponent.removeListenRecognitionStopEvent(t)}removeListenAudioStartEvent(t){return this.mListenComponent.removeListenAudioStartEvent(t)}removeListenAudioStopEvent(t){return this.mListenComponent.removeListenAudioStopEvent(t)}removeListenSoundStartEvent(t){return this.mListenComponent.removeListenSoundStartEvent(t)}removeListenSoundStopEvent(t){return this.mListenComponent.removeListenSoundStopEvent(t)}removeListenSpeechStartEvent(t){return this.mListenComponent.removeListenSpeechStartEvent(t)}removeListenSpeechStopEvent(t){return this.mListenComponent.removeListenSpeechStopEvent(t)}isASR(){return this.mListenComponent.isASR()}setASR(t){return this.mListenComponent.setASR(t)}getASR(){return this.mListenComponent.getASR()}getASRList(){return this.mListenComponent.getASRList()}setTimeout(t){return this.mListenComponent.setTimeout(t)}setLanguage(t){return this.mListenComponent.setLanguage(t)}getLanguage(){return this.mListenComponent.getLanguage()}getLanguageList(){return this.mListenComponent.getLanguageList()}isMode(t){return this.mListenComponent.isMode(t)}isCommandMode(){return this.mListenComponent.isCommandMode()}isDictateMode(){return this.mListenComponent.isDictateMode()}setMode(t){return this.mListenComponent.setMode(t)}getMode(){return this.mListenComponent.getMode()}getModeList(){return this.mListenComponent.getModeList()}abort(){return this.mListenComponent.abort()}}class ft{constructor(){}static create(t,e){try{if(window.cordova&&window.ListenPlugin)return console.log('ListenFactory: mobiles Plugin:',window.ListenPlugin),new Ft(e)}catch(t){console.log('===> EXCEPTION ListenFactory.create: mobile Exception',t.message)}try{return C.findBuilder("Listen")||0===C.insertBuilder("Listen",new _t('',!1))?new Pt(e):(console.log('ListenFactory.create: kein Builder eingetragen'),null)}catch(t){return console.log('ListenFactory.create: web Exception',t),null}}}const Ot={activeFlag:!0,asrList:[],asrDefault:"ASRHtml5",listenLanguage:"de",errorOutputFlag:!1};class Ct extends w{constructor(){if(super("ListenComponent","ListenService","1.6"),this.mListen=null,this.mListenResultEvent=new N(false),this.mListenInterimResultEvent=new N(false),this.mListenNoMatchEvent=new N(false),this.mListenRecognitionStartEvent=new N(false),this.mListenRecognitionStopEvent=new N(false),this.mListenAudioStartEvent=new N(false),this.mListenAudioStopEvent=new N(false),this.mListenSoundStartEvent=new N(false),this.mListenSoundStopEvent=new N(false),this.mListenSpeechStartEvent=new N(false),this.mListenSpeechStopEvent=new N(false),Ct.isConstructorInit()&&0!==this.init(Ct.getConfig()))throw new Error('Listen nicht initialisiert');0!==x.insert(this)&&this._error('ListenBaseService','ListenSerive wurde nicht in ServiceManager eingetragen')}static isConstructorInit(){return Ct.constructorInitFlag}static setConstructorInitOn(){Ct.constructorInitFlag=!0}static setConstructorInitOff(){Ct.constructorInitFlag=!1}static getConfig(){return Ct.listenServiceConfig}_setOption(t){return 0!==super._setOption(t)?-1:('string'==typeof t.listenLanguage&&(this.language=t.listenLanguage),0)}_createComponent(t,e){return null}init(t){return super.init(t)}reset(t){return super.reset(t)}_addAllEvent(t){return 0!==super._addAllEvent(t)?-1:(this.mListen.addListenResultEvent(t,(t=>(this.mListenResultEvent.emit(t),0))),this.mListen.addListenInterimResultEvent(t,(t=>(this.mListenInterimResultEvent.emit(t),0))),this.mListen.addListenNoMatchEvent(t,(()=>(this.mListenNoMatchEvent.emit(),0))),this.mListen.addListenRecognitionStartEvent(t,(()=>(this.mListenRecognitionStartEvent.emit(),0))),this.mListen.addListenRecognitionStopEvent(t,(()=>(this.mListenRecognitionStopEvent.emit(),0))),this.mListen.addListenAudioStartEvent(t,(()=>(this.mListenAudioStartEvent.emit(),0))),this.mListen.addListenAudioStopEvent(t,(()=>(this.mListenAudioStopEvent.emit(),0))),this.mListen.addListenSoundStartEvent(t,(()=>(this.mListenSoundStartEvent.emit(),0))),this.mListen.addListenSoundStopEvent(t,(()=>(this.mListenSoundStopEvent.emit(),0))),this.mListen.addListenSpeechStartEvent(t,(()=>(this.mListenSpeechStartEvent.emit(),0))),this.mListen.addListenSpeechStopEvent(t,(()=>(this.mListenSpeechStopEvent.emit(),0))),0)}get resultEvent(){return this.mListenResultEvent}get interimResultEvent(){return this.mListenInterimResultEvent}get noMatchEvent(){return this.mListenNoMatchEvent}get recognitionStartEvent(){return this.mListenRecognitionStartEvent}get recognitionStopEvent(){return this.mListenRecognitionStopEvent}get audioStartEvent(){return this.mListenAudioStartEvent}get audioStopEvent(){return this.mListenAudioStopEvent}get soundStartEvent(){return this.mListenSoundStartEvent}get soundStopEvent(){return this.mListenSoundStopEvent}get speechStartEvent(){return this.mListenSpeechStartEvent}get speechStopEvent(){return this.mListenSpeechStopEvent}isASR(){return!!this.mListen&&this.mListen.isASR()}setASR(t){return this.mListen?this.mListen.setASR(t):(this._error('setASR','keine Listen-Komponente vorhanden'),-1)}getASR(){return this.mListen?this.mListen.getASR():(this._error('getASR','keine Listen-Komponente vorhanden'),'')}set asr(t){this.setASR(t)}get asr(){return this.getASR()}getASRList(){return this.mListen?this.mListen.getASRList():(this._error('getASRList','keine Listen-Komponente vorhanden'),[])}get asrs(){return this.getASRList()}setTimeout(t){return this.mListen?this.mListen.setTimeout(t):(this._error('setTimeout','keine Listen-Komponente vorhanden'),-1)}setLanguage(t){return this.mListen?this.mListen.setLanguage(t):(this._error('setLanguage','keine Listen-Komponente vorhanden'),-1)}getLanguage(){return this.mListen?this.mListen.getLanguage():(this._error('getLanguage','keine Listen-Komponente vorhanden'),'')}set language(t){this.setLanguage(t)}get language(){return this.getLanguage()}getLanguageList(){return this.mListen?this.mListen.getLanguageList():(this._error('getLanguageList','keine Listen-Komponente vorhanden'),[])}get languages(){return this.getLanguageList()}isMode(t){return this.mListen?this.mListen.isMode(t):(this._error('isMode','keine Listen-Komponente vorhanden'),!1)}isCommandMode(){return this.mListen?this.mListen.isCommandMode():(this._error('isMode','keine Listen-Komponente vorhanden'),!1)}isDictateMode(){return this.mListen?this.mListen.isDictateMode():(this._error('isMode','keine Listen-Komponente vorhanden'),!1)}setMode(t){return this.mListen?this.mListen.setMode(t):(this._error('setMode','keine Listen-Komponente vorhanden'),-1)}getMode(){return this.mListen?this.mListen.getMode():(this._error('getMode','keine Listen-Komponente vorhanden'),'')}set mode(t){this.setMode(t)}get mode(){return this.getMode()}getModeList(){return this.mListen?this.mListen.getModeList():(this._error('getModeList','keine Listen-Komponente vorhanden'),[])}get modes(){return this.getModeList()}abort(){return this.mListen?this.mListen.abort():(this._error('abort','keine Listen-Komponente vorhanden'),-1)}}Ct.listenServiceConfig=Ot,Ct.constructorInitFlag=!0;class Mt extends Ct{constructor(){super()}_createComponent(t,e){return this.mListen=ft.create(t,e),this.mListen}}export{U as LISTEN_API_VERSION,tt as LISTEN_ASYNC_EVENT,z as LISTEN_BUILDER_NAME,ht as LISTEN_COMMAND_MODE,Y as LISTEN_COMPONENTBUILDER_NAME,q as LISTEN_COMPONENTFACTORY_NAME,J as LISTEN_COMPONENT_NAME,rt as LISTEN_DEFAULT_LANGUAGE,at as LISTEN_DEFAULT_MODE,st as LISTEN_DE_LANGUAGE,ct as LISTEN_DICTATE_MODE,ot as LISTEN_EN_LANGUAGE,X as LISTEN_FACTORY_NAME,nt as LISTEN_GOOGLE_ASR,et as LISTEN_HTML5_ASR,it as LISTEN_MICROSOFT_ASR,W as LISTEN_MOCK_NAME,Q as LISTEN_PLUGIN_NAME,$ as LISTEN_SERVICEMOCK_NAME,Z as LISTEN_SERVICE_NAME,j as LISTEN_TYPE_NAME,ut as LISTEN_UNDEFINE_LANGUAGE,mt as LISTEN_UNDEFINE_MODE,D as LISTEN_VERSION_BUILD,B as LISTEN_VERSION_DATE,K as LISTEN_VERSION_NUMBER,V as LISTEN_VERSION_STRING,H as LISTEN_VERSION_TYPE,Pt as Listen,At as ListenComponent,_t as ListenComponentBuilder,Et as ListenComponentFactory,ft as ListenFactory,Ft as ListenMobile,Mt as ListenService,Ot as ListenServiceConfig,y as SPEECHRECOGNITION_FACTORY_NAME,I as SPEECHRECOGNITION_GRAMMAR_NAME,T as SPEECHRECOGNITION_TYPE_NAME,G as SpeechRecognitionFactory};
